namespace FlawlessChips.Tests;

public class FlawlessZ80Tests
{
    [Test]
    public async Task TestStartupStateMatchesVisualZ80()
    {
        var chip = new FlawlessZ80();

        // This state was retrieved from Visual Z80 by running the equivalent simulation,
        // and then calling the JavaScript stateString() function to get the state.
        await Assert.That(chip.GetState()).IsEqualTo(
            "xgvlxllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll");

        chip.Startup();

        // This state was retrieved from Visual Z80 by running the equivalent simulation,
        // and then calling the JavaScript stateString() function to get the state.
        await Assert.That(chip.GetState()).IsEqualTo(
            "xgvlxllllllllllllllllhhhhhhhhhhhllllllllhhllllllllllllhhllllhhllhlhhhlhlllllhllhhllhhllllhhhlhlhlllhhhlllhlllhlhlhllllhllhlhlhhlhlllllllhlhlhhhllllhlhlllllhhhhlllhllhllllllllhlllllllhllllhlhlhhllhhhllhhhlllllhllhllllllhllhllhlhllllllhlhhlhhhhhhllhllllhhhllhhllhllhlhlhllllllllllllllllllllllllllllllllllllllllllllllllllllllllllhlhllllllllllllllllllllllllllllhhhhlllllllllhhlhhhhhhhhhhllhllhhhlhlllhhhhhlhhhhlhhhlhhhhhhhhhhhhhhhhhhhhhhhlhlhhhhhhhhhlhhhllllllhhlllhlllhlhllllhhlllhlhhlllhhhhlhhlllllhlhhhllhhhhhhhhhhhhlhlhhhllhlhlhhhhllhhllhhllhlhlllhhhlllllhlllhlhlllllhlllllllllhhhhhhlhllllllllllllllhhhhhlhhhllhlllllhlllhhhhhhlhlhlhhlhhllhlllhlhhlhlllhllllllllllllllllllllllllllllhhhhhllhhhllhhhhhhhhhhhlhhllhhlllhhhlhhlhhhhhlhhlhhlhllllhhllhhlhhhllhhhhhllhlhhhlhhllhllhhlhhlhhlllhhllhhlhhlhhhlhlhhhhhlhlhllhhhlhhlhllllhlllhhllllhlhlhhhllhhlhlhlhhhlhhhlllhhhllllllhllhhhhlhhhlhllhhhhlhhhlhlllhhhllhlhhlhlhlhllhhllhhhlhhhhhhhllhlhhhlhlhhllhhhlllhlhhhhhlhhhlhhhhlhlhhlhhhlhllhlhhllhhhhlhhhhhlllhhhllhlhhhlhhhhhlhhlllhllhhlhllllllllllllllhllhhlhlhhhlhhhlllhlllhhhhllhllllhllhhlhlhhllhhlllhhlllllhhhhhhhhllllhhlhhlhhllhllhllllhllhhhlhhhhhlhlllhhhllhlllllhllhllhlhllhhhhlhhlhhhlhlhhhlhlhllhhhllhlllllhhlhlhhllhhhlhllhlhhllhlhlhlhhhlhhlllhhhhllllhlhhhhllhhhhhhlllhllhhhllhlhlhlhhhhhhhhllhhhhhlhhlllllhlhlhlhllhlhlhhlhhhlllhhllhlhhlhlhhhlllllhllllhhhlhlhllhhllhlhhlllhhhlllhhllhhlllhlhllhlhhllhlhhlhlhlhlhhlllllhllhhllhhllhlllhhlhlhhlllhhhlhhhhhhlhllhhhhlhhlhhhhlllllllllllhhllhlllllhhllhlhlhllhllllhllhhlllllhlhlhllllhlhlhhhhhhhlhhhhhhhhhhlhhlhlllhllhlhhllhhhhhhhhhllhhhhlhhlllllhlhllllllllhlllhllhlhhlhllhlhllhhlhllllhlhlhlllhllhlllhlllllhhlhlhllhhllhllhlhlhllhlhllhhhlhlhlllhlhlllhhhhhlhhlhlhlhhhhhhhhlhhhhlllhhhhhhhlhllllllhlllhlhlhhlhlhhhlhhhhhhhhhhhlhllllhlhlllhhllhhlhllhhlllllhllhlhlhlhlhhhhhllhhhhhhlhhlhhlhllhlhllhhhhhhhhhhhhhhhlhlhhllllhhhlllllllllllllhlhhhhhllhhhhhhhhhhhhhhhhhlhlhlhhhllllllllllllllhlhhlhlhlllllhhhhhhhhhhhhhlhllhlhhlhlhlhhhhllllllllllllhlllhlllhhlhhhhhhhhhhhhhhhhhlhlhhlhhhllllllllllllllllhhlhhllllhhhhhhhhhhhhhhhlhhlhlhhlhhlllllllllllllhhhhlhhhhhhhhhhhhhhhhhhllhhhlhhlhhllllllllllllllllhllhhhhllllhhhhhhhhhhhhhhhlhhhlhhhlllllllllllllhlhhllhhhhhhhhhhhhhhhhhhlhllhllhlhlhhhhllllllllllllllllhlllllhhhhhhlllhllllllhhhhhhhhhhhhhlhhlhhhlhhhhhllllllllllllhllhlhhhhhhhhhhhhhhhhhhhhlhhhlhhhhllllllllllllllhllllhlllhlhlhlhhhlhllllllhhhhhhhhhhhhhhhhhlhhhlhhlhhllllllllllllllhlhllllhlhlhhhhhhhhhhhhhhhhhhhlhhhllhhhlhhllllllllllllllllhhlhlllhhhhhhhhhhhhhhhlhhhllhllhhlllllllllllllllllhlhlhlhhhlhlhllhhhhhhhhhhhhhhhhhhlhlhhhlhhhhllllllllllllllllllllhllhlhlhhllhllllhhhhhhhhhhhhhhhlhhhllhhhlllllllllllllhlhllhhhhhhhhhhhhhhhhhlllhlhhlhllllllllllllllllllhlhllhhhhhhllhhhhhllllllllhlhhhhlllllhlhhhhhhlllllllllhllllhhhhhllllllllllllhhhhllllllllllllllllllllllllllllllhlllllhllllhlllhlhllllllhlllhlhhllllhlllllhhlhhhlhllhlhlllhlllhllllllllllllhlllhhlhllhllhlhhlhlhhhllhllhhhllllhhhlllhlhhlhllhhlllllhlhhhlllhhllllllhlllhllhhlhlhlllhllhlllllhllllhlhhlllhllllhllllllllllhllllllllllllhhlllllllllhllhhllllllllhllhhlllhlhlllhhllhlllhhllhllhlhlllllllllllhhlllllhllllhlllhllllllhlllllllllllllllllhllllllhllllllllllhllhlllhhlhllllhllllhlhhllhllhlllhlllhlllhllllhllhhhhlhlhllhhhlhhhlhllhhlllllhlhhllllhllhhhlhlhhllhhlhhlhhlllllhlllhhlllhllllhllllllllllllllllllllllllllllhlhlhhhllllhhhhlhllhlhhlhlhlhhllhhhlhlhhhhlhllllhhlhlhlllllllllhlhlhllhhlllhlhhhllllllhhhlhlhhlhlllhlhhllhhhlhhllllhhhhhhhhllhlhhlhhhhhhhllllhhlhlhlhlhlhhlhhhhhhhhllhlhhlhhhllhhhllhllllllllhlhhhllllhhllhllhlhhhlhhhhhhhlllllhllllhhlllhhhhhllhhhlhlhhlllhlhhhhllllllhhhllhhhlhhhlllhlllhlhhhlhhhhhhhhlllllhllllhllhhhlhllhlhhhhhhhhhhhllll");
    }
}